var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-31988700-1']);_gaq.push(['_trackPageview']);(function(){var a=document.createElement('script');a.type='text/javascript';a.async=true;a.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(a,s)})();$.fn.holder=function(){var t=$(this);var h=t.prev();var a=-1*t.position().left;if(a==0)a=parseInt(t.css('margin-left'));var b=-1*t.position().top;if(b==0)b=parseInt(t.css('margin-top'));h.css('left',parseInt(t.css('padding-left'))+a);h.css('top',parseInt(t.css('padding-top'))+b);h.css('font-size',t.css('font-size'));h.css('color',t.css('color'));h.css('font-family',t.css('font-family'));h.css('width',t.css('width'));if(t.val()=='')h.show();else h.hide();t.focusin(function(){h.hide()});t.focusout(function(){if(t.val()=='')h.show()});h.click(function(){t.focus()})};function createWnd(a,b,c,d){var f=$('<div class="wnd" style="width:'+a+'px;height:'+b+'px;"></div>').hide();$('body').append(f);var g=false;var h;var i;var j=$('<div style="cursor:default;padding:0 10px;height:25px;line-height:25px;color:#fff;background:#0d5995">'+c+'</div>').mousedown(function(e){h=e.clientX-parseInt(f.css('left'));i=e.clientY-parseInt(f.css('top'));g=true}).mousemove(function(e){if(g){f.css('left',e.clientX-h).css('top',e.clientY-i)}}).mouseup(function(){g=false}).mouseout(function(){g=false});var k=$('<span class="closebtn" title="关闭">×</span>').click(function(){f.hide()});var l=$('<div class="client" style="position:relative;overflow:auto;width:100%;height:'+(b-25)+'px;"></div>').append(d);f.append(k).append(j).append(l);f.css('top',($(window).height()-parseInt(f.css('height')))/2);f.css('left',($(window).width()-parseInt(f.css('width')))/2);f.show()};function sliderConfirm(d){var e=$('<div style="margin:30px"></div>');var f=$('<div style="margin:10px 0">'+d.title+'</div>');var g=$('<div class="slider"></div>');var h=$('<div class="bar"></div>');var i=$('<div class="thumb"></div>');var j=$('<div class="icon"></div>');var k=$('<div class="tip">滑动确认此操作</div>');i.draggable({revert:function(){return(parseInt(i.css('left'))<=150)},containment:h,axis:'x',stop:function(a,b){if(b.position.left>150){j.css('background-position','-16px 0');var c=d.action();d.callback(k,c)}}});e.append(f).append(g);g.append(h).append(j).append(k);h.append(i);createWnd(400,200,'请确认操作',e)}function msgBox(a,b){var c='<div style="padding:5px 10px;width:280px;height:165px;">'+b+'</div>';createWnd(300,200,a,c)};function checkEmail(a){return/^[\w]+[\w\.]*@[\w-]+\.[\w\.]+$/.test(a)};function checkStuId(b){if(b.length<6)return false;return/^[a-z,A-Z,0-9]+$/.test(b)};function checkPhone(a){return/^\d{11}$/.test(a)};$(function(){$('input,textarea').focusin(function(){$(this).addClass('current')}).focusout(function(){$(this).removeClass('current')});$('.closebtn').click(function(){$(this).parent().hide()});$('#enlist_email').holder();$('#enlist_id').holder();$('#enlist_phone').holder();$('#enlist_txt').holder();$('#comment_email').holder();$('#comment_txt').holder();$('#enlist_bar').click(function(){$('#enlist').css('left','-330px').show().animate({left:0},250)});$('#comment_bar').click(function(){$('#comment').css('left','-330px').show().animate({left:0},250)});var d=document.getElementById('enlist_phone');d.setAttribute('maxlength',11);d.onkeydown=function(a){return(/[\d\t\b]/.test(String.fromCharCode(a.keyCode)))};$('input[name="email"]').each(function(){var e=$(this)[0];e.oninput=function(){$('input[name="email"]').each(function(){if($(this)[0]!=e){$(this).val(e.value);$(this).holder()}})};e.onblur=function(){var v=e.value;if(/^\d+$/.test(v))$('input[name="email"]').each(function(){$(this).val(v+'@qq.com');$(this).holder()})}});$('#enlist_submit').click(function(){if(!checkEmail($('#enlist_email').val())){alert('邮箱格式不合法!')}else if(!checkStuId($('#enlist_id').val())){alert('Are you kidding me! 学号写错了吧...')}else if(!checkPhone($('#enlist_phone').val())){alert('手机号不合法！')}else{$.post('/enlist_submit',{email:$('#enlist_email').val(),stuid:$('#enlist_id').val(),phone:$('#enlist_phone').val(),txt:$('#enlist_txt').val()},function(){$('#enlist_txt').val('');msgBox('Information','提交成功！')})}});$('#comment_submit').click(function(){if(!checkEmail($('#comment_email').val())){alert('邮箱格式不合法!')}else{$.post('/suggestion_submit',{email:$('#comment_email').val(),txt:$('#comment_txt').val()},function(){$('#comment_txt').val('');msgBox('Information','提交成功！')})}})});